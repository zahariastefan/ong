{% extends 'base.html.twig' %}

{% block body %}
<div class="jumbotron-img p-2 mb-2">
    <div class="container">
        <h1 class="display-4 text-center">Welcome to my Blog</h1>
        {% if alertDisabled2fa %}
            <div class="alert alert-success">You Successfully Disabled Two Factors Authentication</div>
        {% endif %}
{#        <div class="lead">And even answers for those questions you didn't think to ask!</div>#}
    </div>
</div>
<div class="container">
    {% if is_granted('ROLE_ADMIN') %}
        <div class="col mb-3">
            <div class="col">
                <a class="btn btn-question" href="{{ path('app_post_create') }}">Create a Post</a>
            </div>
        </div>
    {% endif %}
    <div class="row">
        <div class="col-2">
            <div class="btn-group">
                <!-- Button trigger modal -->
                <button type="button" id="new-trip" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                    New Trip
                </button>            </div>
        </div>

        <div class="col-8">
            {% for question in pager %}
                <div class="col-12 mb-3 card_preview_post_homepage">
                    <div style="box-shadow: 2px 3px 9px 4px rgba(0,0,0,0.04);">
                        <div class="q-container p-4">
                            <div class="row">
                                <div class="col-2 text-center">
                                    <img src="{{ question.owner.avatarUri }}" width="100" height="100"  alt="{{ question.owner.avatarUri }} avatar">
                                    <div class="vote-arrows vote-arrows-alt flex-fill pt-2" style="min-width: 90px;">
                                        <span>{{ question.likeNr + question.unLikeNr }} votes</span>
                                    </div>
                                    {% for questionTag in question.questionTags %}
                                        <span class="badge rounded-pill bg-light text-dark">{{ questionTag.tag.name }}</span>
                                    {% endfor %}
                                </div>
                                <div class="col">
                                    <a class="q-title" href="{{ path('app_question_show', { slug: question.slug }) }}"><h2>{{ question.name }}</h2></a>
                                    <div class="q-display p-3 container_content_hmp">
                                        <i class="fa fa-quote-left mr-3"></i>
                                        <p class="d-inline paragraph_content_homepage">{{ question.question|slice(0, 250) }}</p>
                                        <i class="fa fa-quote-right mr-3"></i>
                                        <p class="pt-4"><strong>--{{ question.owner.displayName }}</strong></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a class="answer-link" href="{{ path('app_question_show', { slug: question.slug }) }}" >
                            <p class="q-display-response bg-info text-center p-3">
                                <i class="fa fa-magic magic-wand"></i> {{ question.approvedAnswers|length }} comments
                            </p>
                        </a>
                    </div>
                </div>
            {% endfor %}

            {{ pagerfanta(pager) }}
        </div>

        <div class="col-2">Hello</div>

    </div>

    {{ include('trip/modal-create-trip.html.twig') }}

</div>
    <script>
        $('#myModal').on('shown.bs.modal', function () {
            $('#myInput').trigger('focus')
        });
        var path = '{{ path('app_locations') }}';
        var fullUrl   = window.location.origin + path;

        $('#new-trip').click(()=>{
            $.ajax({
                type: "POST",
                url: fullUrl,
                // data: {direction:direction},
                complete: function (data) {
                    var array = data.responseJSON;
                    console.log(array.length);
                    for(var x = 0;x < array.length; x++){
                        $('.modal-body').append('' +
                            '<form action="{{ path("app_trip_create") }}" id="form-modal-body'+x+'">' +
                            '<p class="city-location" id="city-location'+x+'">'+array[x]['city']+' ('+array[x]['country']+')</p>' +
                            '<input name ="location_name" type="hidden" class="city-location'+x+'" value=\'{"city":"'+array[x]['city']+ '" , "country": "' +array[x]['country'] +'"} \' >' +
                            '<button type="submit" class="city-location'+x+'" style="display:none"></button>' +
                            '</form>');

                    }

                    //get current element and pass the data to the action page from form
                    $('p[class^="city"]').click((event)=>{
                        var id = $(event.target).attr('id');
                        $('.'+id).trigger('click');
                    });
                }
            });
        });



    </script>
{% endblock %}

